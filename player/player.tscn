[gd_scene load_steps=20 format=2]

[ext_resource path="res://player/player.gd" type="Script" id=1]
[ext_resource path="res://player/ground_checker.gd" type="Script" id=2]
[ext_resource path="res://fonts/player_text_bold.tres" type="DynamicFont" id=3]
[ext_resource path="res://player/scene_cam.gd" type="Script" id=4]
[ext_resource path="res://fonts/player_text_normal.tres" type="DynamicFont" id=5]
[ext_resource path="res://player/fsm/player-statemachine.gd" type="Script" id=6]
[ext_resource path="res://player/debug_info.gd" type="Script" id=8]
[ext_resource path="res://player/fsm/state-no-item.gd" type="Script" id=9]
[ext_resource path="res://player/fsm/state-holding-item.gd" type="Script" id=10]
[ext_resource path="res://player/fsm/state-examining.gd" type="Script" id=11]
[ext_resource path="res://player/feet_audio_player.gd" type="Script" id=12]
[ext_resource path="res://player/shadow_mesh/shadow_mesh_one_arm_no_legs.obj" type="ArrayMesh" id=13]
[ext_resource path="res://player/shadow_mesh.gd" type="Script" id=14]
[ext_resource path="res://player/text_display.gd" type="Script" id=15]

[sub_resource type="CylinderShape" id=11]
margin = 0.044
height = 2.036
radius = 0.35

[sub_resource type="CylinderShape" id=12]
margin = 0.044
height = 1.10487
radius = 0.35

[sub_resource type="SpatialMaterial" id=6]
flags_unshaded = true
flags_do_not_receive_shadows = true
flags_disable_ambient_light = true
albedo_color = Color( 0, 0, 0, 0 )

[sub_resource type="SpatialMaterial" id=5]
flags_unshaded = true
flags_no_depth_test = true
flags_use_point_size = true
flags_do_not_receive_shadows = true
flags_disable_ambient_light = true

[sub_resource type="SpatialMaterial" id=10]
albedo_color = Color( 0, 0.0862745, 1, 1 )

[node name="Player" type="KinematicBody"]
collision_layer = 2
input_ray_pickable = false
script = ExtResource( 1 )

[node name="body" type="CollisionShape" parent="."]
unique_name_in_owner = true
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.018, 0 )
shape = SubResource( 11 )

[node name="body_crouched" type="CollisionShape" parent="."]
unique_name_in_owner = true
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.553, 0 )
visible = false
shape = SubResource( 12 )
disabled = true

[node name="head_spot_crouched" type="Spatial" parent="."]
unique_name_in_owner = true
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.94, -0.228 )

[node name="ground_checker" type="RayCast" parent="."]
unique_name_in_owner = true
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.18706, 0 )
enabled = true
cast_to = Vector3( 0, -0.765, 0 )
debug_shape_custom_color = Color( 0, 0.564706, 0.0745098, 1 )
debug_shape_thickness = 4
script = ExtResource( 2 )

[node name="fall_checker" type="RayCast" parent="."]
unique_name_in_owner = true
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.18706, 0 )
enabled = true
cast_to = Vector3( 0, -8, 0 )
debug_shape_custom_color = Color( 1, 1, 1, 1 )
debug_shape_thickness = 4
script = ExtResource( 2 )

[node name="slope_checker" type="RayCast" parent="."]
unique_name_in_owner = true
transform = Transform( 1, 0, 0, 0, 0.842923, -0.538035, 0, 0.538035, 0.842923, 0, 1.18706, 0 )
enabled = true
cast_to = Vector3( 0, -0.7, 0 )
debug_shape_custom_color = Color( 0.658824, 0, 0, 1 )
debug_shape_thickness = 5
script = ExtResource( 2 )

[node name="feet_audio_player" type="AudioStreamPlayer3D" parent="."]
unique_name_in_owner = true
transform = Transform( 1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, -0.00149916, 0.409437, 0.530127 )
bus = "Steps"
script = ExtResource( 12 )

[node name="shadow_mesh" type="MeshInstance" parent="."]
unique_name_in_owner = true
transform = Transform( -0.38637, 3.43733e-08, -0.103528, 2.98479e-08, 0.4, 2.14141e-08, 0.103528, 1.29592e-08, -0.38637, 0, -0.0357835, 0.134601 )
generate_lightmap = false
mesh = ExtResource( 13 )
skeleton = NodePath("../body")
software_skinning_transform_normals = false
material/0 = SubResource( 6 )
script = ExtResource( 14 )

[node name="Head" type="Spatial" parent="."]
unique_name_in_owner = true
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.54406, -0.227731 )

[node name="Camera" type="Camera" parent="Head"]
unique_name_in_owner = true
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.418923, 0 )
current = true
far = 200.0
script = ExtResource( 4 )

[node name="InterractionRay" type="RayCast" parent="Head/Camera"]
unique_name_in_owner = true
enabled = true
cast_to = Vector3( 0, 0, -20 )
collision_mask = 129
debug_shape_custom_color = Color( 0.839216, 0, 1, 1 )

[node name="target" type="CSGBox" parent="Head/Camera/InterractionRay"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -2 )
cast_shadow = 0
generate_lightmap = false
width = 0.003
height = 0.006
depth = 0.052
material = SubResource( 5 )

[node name="right_hand" type="Spatial" parent="Head/Camera"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0.493, -0.384, -0.509 )
visible = false

[node name="examination_spot" type="Spatial" parent="Head/Camera"]
transform = Transform( 0.777462, 0.36233, -0.514073, -0.626944, 0.5114, -0.587718, 0.0499492, 0.779223, 0.624754, 0, 0, -0.643 )
visible = false

[node name="center_holding_spot" type="Spatial" parent="Head/Camera"]
transform = Transform( 1, 0, 0, 0, 0.966583, -0.256357, 0, 0.256357, 0.966583, 0, -0.125, -0.7 )
visible = false

[node name="CSGBox" type="CSGBox" parent="Head/Camera/center_holding_spot"]
transform = Transform( 1, 0, 0, 0, 0.980771, 0.195159, 0, -0.195159, 0.980771, 0, 0, 0 )
visible = false
width = 0.1
height = 0.1
depth = 0.1
material = SubResource( 10 )

[node name="crouch_tween" type="Tween" parent="Head/Camera"]

[node name="debug_status" type="RichTextLabel" parent="Head/Camera"]
unique_name_in_owner = true
margin_left = 698.0
margin_top = 27.0
margin_right = 1307.0
margin_bottom = 1016.0
meta_underlined = false
text = "Debug Status"
fit_content_height = true
scroll_active = false

[node name="debug_info" type="RichTextLabel" parent="Head/Camera"]
visible = false
margin_left = 47.0
margin_top = 29.0
margin_right = 656.0
margin_bottom = 1018.0
meta_underlined = false
text = "Debug Info: F1

Move: WASD keys or arrow keys
Crouch: CTRL to toggle, C to hold
Run: hold Shift while moving
Take Item: left mouse button or E key
Use Held Item: right mouse button or F key
Put Item In Front Of You: SPACE key
Drop Item: R key

Examine Item: TAB key
Rotate Examined Item: WASDEQ keys
    OR hold left mouse button or SPACE key and mouve the mouse

Release window focus: Escape key

Pixelated Screen: 7
Fog: 8
Glow: 9
Air Dust: 0

Jump to next Spawn point: K 
"
fit_content_height = true
scroll_active = false

[node name="debug_info_before" type="RichTextLabel" parent="Head/Camera"]
margin_left = 47.0
margin_top = 29.0
margin_right = 656.0
margin_bottom = 1018.0
meta_underlined = false
text = "Type F1 for keys and info"
fit_content_height = true
scroll_active = false
script = ExtResource( 8 )

[node name="text_display" type="RichTextLabel" parent="Head/Camera"]
unique_name_in_owner = true
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
margin_left = -554.0
margin_top = -279.0
margin_right = 559.0
margin_bottom = -86.0
custom_colors/default_color = Color( 1, 1, 1, 1 )
custom_colors/font_color_selected = Color( 1, 1, 1, 1 )
custom_colors/font_color_shadow = Color( 0.427451, 0.141176, 0.141176, 1 )
custom_fonts/bold_font = ExtResource( 3 )
custom_fonts/normal_font = ExtResource( 5 )
bbcode_enabled = true
bbcode_text = "This is the text being displayed [b]to the player[/b]"
text = "This is the text being displayed to the player"
scroll_active = false
script = ExtResource( 15 )

[node name="text_tween" type="Tween" parent="Head/Camera/text_display"]

[node name="PlayerStateMachine" type="Node" parent="."]
script = ExtResource( 6 )

[node name="State_Examining" type="Node" parent="PlayerStateMachine"]
script = ExtResource( 11 )

[node name="State_NoItem" type="Node" parent="PlayerStateMachine"]
script = ExtResource( 9 )

[node name="State_HoldingItem" type="Node" parent="PlayerStateMachine"]
script = ExtResource( 10 )

[node name="close_visibility" type="OmniLight" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.04635, 0 )
light_energy = 0.01
omni_range = 0.894
